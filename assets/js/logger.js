!function(t){var o={};function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(n,e){if(1&e&&(n=r(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)r.d(t,o,function(e){return n[e]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=8)}({8:function(e,n,t){e.exports=t(9)},9:function(module,exports){function x(e){if(w[e])return w[e].exports;var n=w[e]={i:e,l:!1,exports:{}};return v[e].call(n.exports,n,n.exports,x),n.l=!0,n.exports}var v,w;v={"./assets/es6/_functions.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"add\", function() { return add; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ADYEN\", function() { return ADYEN; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"prefixIt\", function() { return prefixIt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"blockSection\", function() { return blockSection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unBlockSection\", function() { return unBlockSection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isJson\", function() { return isJson; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"elemSendAjaxCall\", function() { return elemSendAjaxCall; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"debugLog\", function() { return debugLog; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showInstallmentsField\", function() { return showInstallmentsField; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearCardForm\", function() { return clearCardForm; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setEncryptedCardData\", function() { return setEncryptedCardData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"generateCardForm\", function() { return generateCardForm; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"generateApplePay\", function() { return generateApplePay; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"generateGooglePay\", function() { return generateGooglePay; });\nfunction add(x, y){\n   return x + y;\n}\n\nfunction ADYEN(){\n   return woosa_adn;\n}\n\nfunction prefixIt(selector, type = ''){\n   return type+ADYEN().prefix+selector;\n}\n\nfunction blockSection(elem) {\n   jQuery(elem).block({\n      message: null,\n      overlayCSS: {\n         background: '#fff',\n         opacity: 0.6\n      }\n   });\n}\n\nfunction unBlockSection(elem) {\n   jQuery(elem).unblock();\n}\n\nfunction isJson(str) {\n   try{\n      JSON.parse(str);\n   }catch (e){\n      //Error\n      //JSON is not okay\n      return false;\n   }\n\n  return true;\n}\n\nfunction elemSendAjaxCall(target){\n\n   jQuery(function($){\n\n      let is_processing = false;\n\n      $(document).on('click', target, function(e){\n\n         e.preventDefault();\n\n         let btn = $(this),\n            action = btn.attr('data-'+prefixIt('-action')),\n            extra = isJson(btn.attr('data-'+prefixIt('-extra'))) ? JSON.parse(btn.attr('data-'+prefixIt('-extra'))) : btn.attr('data-'+prefixIt('-extra')),\n            processing_label = ADYEN().translation.processing,\n            parentElem = btn.parent(),\n            fields = btn.closest('#mainform').find(':input').serialize();\n\n         if(is_processing) return;\n\n         $.ajax({\n            url: ADYEN().ajax.url,\n            method: 'POST',\n            data: {\n               action: prefixIt('_'+action),\n               security: ADYEN().ajax.nonce,\n               extra: extra,\n               fields: fields,\n            },\n            beforeSend: function(){\n\n               is_processing = true;\n\n               blockSection('#wpcontent');\n\n               btn.data('label', btn.text());\n               btn.text(processing_label).attr('disabled', true);\n\n               parentElem.parent().find(prefixIt('-error-text', '.')).remove();\n            },\n            success: function(res){\n\n               if(res.success){\n                  window.location.reload();\n               }else{\n                  $('<p class=\"'+prefixIt('-error-text')+'\">'+res.data.message+'</p>').insertAfter(parentElem);\n                  btn.text( btn.data('label') ).attr('disabled', false);\n                  unBlockSection('#wpcontent');\n               }\n            },\n            complete: function(){\n\n               is_processing = false;\n            }\n         });\n      });\n\n   });\n\n}\n\nfunction debugLog(msg){\n   if(ADYEN().debug){\n      console.log('%cDEBUG LOG: '+msg, \"color: orange\");\n   }\n}\n\n\nfunction showInstallmentsField(){\n   let interval = setInterval(() => {\n      if(jQuery('.adyen-checkout__spinner__wrapper').parent().is(':hidden')){\n         jQuery(prefixIt('-installments-field', '.')).fadeIn();\n         clearInterval(interval);\n      }\n   }, 100);\n}\n\n\n/**\n * Clear card form data from hidden fileds.\n *\n * @since 1.1.1 - change function name\n * @since 1.0.6\n * @param {string} methodType\n */\nfunction clearCardForm(methodType){\n\n   jQuery(prefixIt('-'+methodType+'-card-number', '#')).val('');\n   jQuery(prefixIt('-'+methodType+'-card-exp-month', '#')).val('');\n   jQuery(prefixIt('-'+methodType+'-card-exp-year', '#')).val('');\n   jQuery(prefixIt('-'+methodType+'-card-cvc', '#')).val('');\n   jQuery(prefixIt('-'+methodType+'-card-holder', '#')).val('');\n   jQuery(prefixIt('-'+methodType+'-sci', '#')).val('');\n   jQuery(prefixIt('-'+methodType+'-store-card', '#')).val('');\n\n   debugLog('Clear the encrypted card data.');\n\n}\n\n\n/**\n * Fills the encrypted card data in hidden fields.\n *\n * @since 1.1.1\n * @param {object} state\n */\nfunction setEncryptedCardData(state, component = {}, methodType = ''){\n\n   if(state && state.isValid){\n      let store_card = state.data.storePaymentMethod ? state.data.storePaymentMethod : '0';\n\n      if(state.data.paymentMethod.type == 'scheme'){\n\n         if(component._node){\n\n            jQuery('#'+component._node.id).data('card_state', state);\n\n            debugLog('Saved temporarily the encrypted card data on the element.');\n\n         }\n\n         jQuery(prefixIt('-'+methodType+'-card-number', '#')).val(state.data.paymentMethod.encryptedCardNumber);\n         jQuery(prefixIt('-'+methodType+'-card-exp-month', '#')).val(state.data.paymentMethod.encryptedExpiryMonth);\n         jQuery(prefixIt('-'+methodType+'-card-exp-year', '#')).val(state.data.paymentMethod.encryptedExpiryYear);\n         jQuery(prefixIt('-'+methodType+'-card-cvc', '#')).val(state.data.paymentMethod.encryptedSecurityCode);\n         jQuery(prefixIt('-'+methodType+'-card-holder', '#')).val(state.data.paymentMethod.holderName);\n         jQuery(prefixIt('-'+methodType+'-sci', '#')).val(state.data.paymentMethod.storedPaymentMethodId);\n         jQuery(prefixIt('-'+methodType+'-store-card', '#')).val(store_card);\n\n         debugLog('Set the encrypted card data.');\n\n      }\n\n   }else{\n\n      clearCardForm(methodType);\n   }\n}\n\n\n/**\n * Generates the card form fields.\n *\n * @since 1.1.3 - add support for Web Component v4.4.0 - configuration object should be pased to create()\n * @since 1.1.1 - do not mount the component everytime a click takes place but only set the encrypted data\n *              - change function name\n * @since 1.0.0\n * @param {object} checkout\n */\nfunction generateCardForm(checkout){\n\n   jQuery('[data-'+prefixIt('-stored-card')+']').off('click').on('click', function(){\n\n      let _this        = jQuery(this),\n         parent        = _this.parent(),\n         current       = parent.find(prefixIt('-stored-card__fields', '.')),\n         methodType    = _this.attr('data-'+prefixIt('-stored-card-type')),\n         formElemId    = _this.attr('data-'+prefixIt('-stored-card')),\n         formElem      = jQuery('#'+formElemId),\n         formType      = 'scheme' === methodType ? 'card' : methodType,\n         cardState     = formElem.data('card_state'),\n         methodIndex   = formElemId.replace(/[^0-9\\.]/g, ''),\n         storedMethods = checkout.paymentMethodsResponse.storedPaymentMethods;\n\n\n      if(formElem.length > 0){\n\n         //new card\n         if( '' === methodIndex){\n\n            if( '' == formElem.children(0).html() ){\n\n               checkout.create(formType, {\n                  brands: ADYEN().api.card_types,\n                  enableStoreDetails: ADYEN().api.store_card,\n                  hasHolderName: true,\n                  holderNameRequired: true,\n               }).mount('#'+formElemId);\n\n               debugLog('Initiated the form for using a new card.');\n\n            }else{\n\n               setEncryptedCardData(cardState, {}, methodType);\n            }\n\n            jQuery(prefixIt('-'+methodType+'-is-stored-card', '#')).val('no');\n\n         //stored card\n         }else{\n\n            if('' == formElem.html()){\n\n               checkout.create(formType, storedMethods[methodIndex]).mount('#'+formElemId);\n\n               debugLog('Initiated the form for the existing card.');\n\n            }else{\n\n               setEncryptedCardData(cardState, {}, methodType);\n            }\n\n            jQuery(prefixIt('-'+methodType+'-is-stored-card', '#')).val('yes');\n         }\n      }\n\n      jQuery(prefixIt('-stored-card__fields', '.')).closest(prefixIt('-stored-card', '.')).not(parent).removeClass('selected');\n      jQuery(prefixIt('-stored-card__fields', '.')).not(current).slideUp();\n\n      current.slideToggle();\n      parent.addClass('selected');\n   });\n}\n\n\n/**\n * Generates AppleyPay button.\n * @since unkown\n * @param {object} checkout\n */\nfunction generateApplePay(checkout){\n\n   // const apple_merchant_name = jQuery('#woosa_adyen_applepay_merchant_name').val(),\n   //       apple_merchant_identifier = jQuery('#woosa_adyen_applepay_merchant_identifier').val();\n\n   // const applepay = checkout.create(\"applepay\", {\n   //    currencyCode: ADYEN().currency,\n   //    amount: (ADYEN().cart.total) * 100, //it's in cents\n   //    countryCode: ADYEN().cart.country,\n   //    configuration: {\n   //       merchantName: apple_merchant_name,\n   //       merchantIdentifier: apple_merchant_identifier\n   //    },\n   //    // Button config\n   //    buttonType: \"buy\", // Optional. The type of button you want to be displayed in the payments form\n   //    buttonColor: \"black\", // Optional. Specify the color of the button\n   //    onValidateMerchant: (resolve, reject, validationURL) => {\n   //       // Call the validation endpoint with validationURL.\n   //       // Call resolve(MERCHANTSESSION) or reject() to complete merchant validation.\n   //    }\n   // });\n\n   // applepay\n   //    .isAvailable()\n   //    .then(() => {\n   //       applepay.mount(\"#applepay-container\");\n   //    })\n   //    .catch(e => {\n   //       console.log(e)\n   //       jQuery('.payment_method_woosa_adyen_applepay').remove();\n   //    });\n}\n\n\n\n/**\n * Generates GooglePay button.\n *\n * @since 1.1.0\n * @param {object} checkout\n */\nfunction generateGooglePay(checkout){\n\n   if(jQuery('#woosa_adyen_googlepay_button').length > 0){\n\n      const test_mode = 'yes' !== jQuery('#woosa_adyen_googlepay_testmode').val() && 'yes' !== ADYEN().api.test_mode ? false : true,\n         merchant_id = jQuery('#woosa_adyen_googlepay_merchant_identifier').val();\n\n      let config = {\n         gatewayMerchantId: ADYEN().api.adyen_merchant,\n         merchantName: ADYEN().site_name\n      };\n\n      if( test_mode ){\n         config.merchantIdentifier = merchant_id;\n      }\n\n      const googlepay = checkout.create(\"paywithgoogle\", {\n         environment: test_mode ? 'TEST' : 'PRODUCTION',\n         amount: {\n            currency: ADYEN().currency,\n            value: (ADYEN().cart.total) * 100, //it's in cents\n         },\n         configuration: config,\n         buttonColor: \"white\",\n         onAuthorized: (data) => {\n\n            jQuery('#'+ADYEN().prefix+'-googlepay-container .googlepay-description').html(data.paymentMethodData.description).show();\n            jQuery('#woosa_adyen_googlepay_description').val(data.paymentMethodData.description);\n            jQuery('#woosa_adyen_googlepay_token').val(data.paymentMethodData.tokenizationData.token);\n         }\n      });\n\n\n      googlepay\n         .isAvailable()\n         .then(() => {\n\n            if(jQuery('.adyen-checkout__paywithgoogle').length == 0){\n               googlepay.mount(\"#woosa_adyen_googlepay_button\");\n            }\n\n         })\n         .catch(e => {\n            console.log(e);\n            jQuery('.wc_payment_method .payment_method_woosa_adyen_googlepay').remove();\n         });\n   }\n}\n\n\n//# sourceURL=webpack:///./assets/es6/_functions.js?")},"./assets/es6/logger.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _functions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_functions */ \"./assets/es6/_functions.js\");\n\n\n\njQuery(function($){\n\n\n   /**\n    * Init notification box\n    * @since 1.0.0\n    */\n   setTimeout(function(){\n      $(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-notification', '.')).each(function(index, item){\n         let offset = 110,\n            bottom = index == 0 ? 10 : offset * index;\n\n         $(this).animate({\n            'bottom': bottom\n         }).slideDown('fast');\n      });\n   }, 800);\n\n\n   /**\n    * Close notification box\n    * @since 1.0.0\n    */\n   $(document).on('click', Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-notification__close', '.'), function(){\n      $(this).closest(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-notification', '.')).hide();\n\n      //refresh bottom position\n      $(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-notification:visible', '.')).each(function(index, item){\n         let offset = 110,\n            bottom = index == 0 ? 10 : offset * index;\n\n         $(this).animate({\n            'bottom': bottom\n         }).slideDown('fast');\n      });\n   });\n\n\n   /**\n    * Enable the action buttons when at least a checkbox field is checked\n    * @since 1.0.0\n    */\n   $(document).on('change', '[data-'+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-checkbox')+']', function(){\n\n      window.onbeforeunload = null;//prevent the window which says \"the changes may be lost\"\n\n      let _this = $(this),\n         log_list = _this.closest(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-logs', '.'));\n\n      if(log_list.find('input:checkbox:checked').length > 0){\n         log_list.find(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-actions__right button', '.')).prop('disabled', false);\n      }else{\n         log_list.find(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-actions__right button', '.')).prop('disabled', true);\n      }\n\n   });\n\n\n\n   /**\n    * Runs the selected action.\n    * @since 1.0.0\n    */\n   $(document).on('click', '[data-'+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-action')+']', function(e){\n\n      let _this = $(this),\n         log_action = _this.attr('data-'+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-action')),\n         log_elem = _this.closest('[data-'+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-code')+']'),\n         log_list = _this.closest(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-logs', '.')),\n         log_code = log_elem.attr('data-'+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-code'));\n\n      if('view_detail' === log_action){\n\n         let url = Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"ADYEN\"])().ajax.url+'?action='+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('_log_action')+'&security='+Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"ADYEN\"])().ajax.nonce+'&log_action='+log_action+'&log_code='+log_code+'&width=700&height=700';\n\n         tb_show('Log detail', url);\n\n      }else if('select_all' === log_action){\n\n         let checked = _this.data('checked');\n\n         if(checked == true){\n\n            _this.data('checked', false);\n            checked = false;\n            _this.removeClass('button-primary');\n\n            log_list.find(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-actions__right button', '.')).prop('disabled', true);\n\n         }else{\n\n            _this.data('checked', true);\n            checked = true;\n            _this.addClass('button-primary');\n\n            log_list.find(Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('-log-actions__right button', '.')).prop('disabled', false);\n         }\n\n         log_list.find('input:checkbox').prop('checked', checked);\n\n      }else{\n\n         let log_codes = [];\n\n         log_list.find('input:checkbox:checked').each(function(){\n            log_codes.push($(this).val());\n         });\n\n         if('remove' === log_action){\n            if( ! window.confirm('Are you sure you want to remove this log?') ) {\n               return;\n            }\n         }\n\n         $.ajax({\n            url: Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"ADYEN\"])().ajax.url,\n            method: 'POST',\n            data: {\n               action: Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"prefixIt\"])('_log_action'),\n               security: Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"ADYEN\"])().ajax.nonce,\n               log_action: log_action,\n               log_codes: log_codes,\n            },\n            beforeSend: function(){\n\n               _this.attr('disabled', true);\n               Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"blockSection\"])('#wpcontent');\n\n            },\n            success: function(res){\n\n               if(res.success){\n\n                  window.location.reload();\n\n               }else{\n\n                  console.error(res.data.message);\n\n                  _this.attr('disabled', false);\n                  Object(_functions__WEBPACK_IMPORTED_MODULE_0__[\"unBlockSection\"])('#wpcontent');\n               }\n            },\n         });\n      }\n\n   });\n\n});\n\n//# sourceURL=webpack:///./assets/es6/logger.js?")},4:function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__(/*! /home/cosmin/Documents/Woosa/Projects/woosa-adyen/assets/es6/logger.js */"./assets/es6/logger.js");\n\n\n//# sourceURL=webpack:///multi_./assets/es6/logger.js?')}},w={},x.m=v,x.c=w,x.d=function(e,n,t){x.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},x.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},x.t=function(n,e){if(1&e&&(n=x(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(x.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)x.d(t,o,function(e){return n[e]}.bind(null,o));return t},x.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return x.d(n,"a",n),n},x.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},x.p="",x(x.s=4)}});